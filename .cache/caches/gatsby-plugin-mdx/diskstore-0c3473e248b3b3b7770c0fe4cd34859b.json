{"expireTime":9007200852240999000,"key":"gatsby-plugin-mdx-entire-payload-39b8c84ab88818dec1fcaf706f8b25ad-","val":{"mdast":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"분류를 목적으로 하는 지도학습의 일종","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":21,"offset":21},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"베이즈 정리","position":{"start":{"line":4,"column":5,"offset":27},"end":{"line":4,"column":11,"offset":33},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":23},"end":{"line":4,"column":11,"offset":33},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"두 확률 변수의 사전확률과 사후 확률 사이의 관계를 나타내는 정리","position":{"start":{"line":6,"column":3,"offset":37},"end":{"line":6,"column":39,"offset":73},"indent":[]}}],"position":{"start":{"line":6,"column":3,"offset":37},"end":{"line":6,"column":39,"offset":73},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"사전 확률 정보를 이용해 사후 확률을 추정","position":{"start":{"line":7,"column":7,"offset":80},"end":{"line":7,"column":30,"offset":103},"indent":[]}}],"position":{"start":{"line":7,"column":7,"offset":80},"end":{"line":7,"column":30,"offset":103},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":76},"end":{"line":7,"column":30,"offset":103},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"사전확률","position":{"start":{"line":8,"column":9,"offset":112},"end":{"line":8,"column":13,"offset":116},"indent":[]}}],"position":{"start":{"line":8,"column":7,"offset":110},"end":{"line":8,"column":15,"offset":118},"indent":[]}},{"type":"text","value":" : 가지고 있는 정보를 기초로 정한 초기 확률.","position":{"start":{"line":8,"column":15,"offset":118},"end":{"line":8,"column":42,"offset":145},"indent":[]}}],"position":{"start":{"line":8,"column":7,"offset":110},"end":{"line":8,"column":42,"offset":145},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"A : 사건의 원인, B : 결과, P(A) : 원인의 사전확률, P(B) : 결과의 사전확률","position":{"start":{"line":9,"column":11,"offset":156},"end":{"line":9,"column":63,"offset":208},"indent":[]}}],"position":{"start":{"line":9,"column":11,"offset":156},"end":{"line":9,"column":63,"offset":208},"indent":[]}}],"position":{"start":{"line":9,"column":7,"offset":152},"end":{"line":9,"column":63,"offset":208},"indent":[]}}],"position":{"start":{"line":9,"column":7,"offset":152},"end":{"line":9,"column":63,"offset":208},"indent":[]}}],"position":{"start":{"line":8,"column":3,"offset":106},"end":{"line":9,"column":63,"offset":208},"indent":[3]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"사후확률","position":{"start":{"line":10,"column":9,"offset":217},"end":{"line":10,"column":13,"offset":221},"indent":[]}}],"position":{"start":{"line":10,"column":7,"offset":215},"end":{"line":10,"column":15,"offset":223},"indent":[]}},{"type":"text","value":" : 결과가 발생했다는 조건에서 어떤 원인이 발생했을 확률. P(A|B)","position":{"start":{"line":10,"column":15,"offset":223},"end":{"line":10,"column":55,"offset":263},"indent":[]}}],"position":{"start":{"line":10,"column":7,"offset":215},"end":{"line":10,"column":55,"offset":263},"indent":[]}}],"position":{"start":{"line":10,"column":3,"offset":211},"end":{"line":10,"column":55,"offset":263},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"우도","position":{"start":{"line":11,"column":9,"offset":272},"end":{"line":11,"column":11,"offset":274},"indent":[]}}],"position":{"start":{"line":11,"column":7,"offset":270},"end":{"line":11,"column":13,"offset":276},"indent":[]}},{"type":"text","value":" : 원인이 발생했다는 조건에서 결과가 발생했을 확률. P(B|A)","position":{"start":{"line":11,"column":13,"offset":276},"end":{"line":11,"column":50,"offset":313},"indent":[]}}],"position":{"start":{"line":11,"column":7,"offset":270},"end":{"line":11,"column":50,"offset":313},"indent":[]}}],"position":{"start":{"line":11,"column":3,"offset":266},"end":{"line":11,"column":50,"offset":313},"indent":[]}}],"position":{"start":{"line":7,"column":3,"offset":76},"end":{"line":11,"column":50,"offset":313},"indent":[3,3,3,3]}}],"position":{"start":{"line":6,"column":1,"offset":35},"end":{"line":11,"column":50,"offset":313},"indent":[1,1,1,1,1]}}],"position":{"start":{"line":6,"column":1,"offset":35},"end":{"line":11,"column":50,"offset":313},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"./ch7.png","alt":"베이즈정리","position":{"start":{"line":13,"column":1,"offset":315},"end":{"line":13,"column":20,"offset":334},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":315},"end":{"line":13,"column":20,"offset":334},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"라플라스 스무딩","position":{"start":{"line":16,"column":5,"offset":366},"end":{"line":16,"column":13,"offset":374},"indent":[]}}],"position":{"start":{"line":16,"column":1,"offset":362},"end":{"line":16,"column":13,"offset":374},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"나이브 베이즈 분류기에서 학습되지 않은 새로운 입력 벡터가 입력될 경우 조건부 확률이 0이 되는 문제 발생","position":{"start":{"line":18,"column":3,"offset":378},"end":{"line":18,"column":62,"offset":437},"indent":[]}}],"position":{"start":{"line":18,"column":3,"offset":378},"end":{"line":18,"column":62,"offset":437},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":376},"end":{"line":18,"column":62,"offset":437},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"이 문제를 해결하기 위해 확률값을 보정하는데 사용하는 기법","position":{"start":{"line":19,"column":3,"offset":440},"end":{"line":19,"column":35,"offset":472},"indent":[]}}],"position":{"start":{"line":19,"column":3,"offset":440},"end":{"line":19,"column":35,"offset":472},"indent":[]}}],"position":{"start":{"line":19,"column":1,"offset":438},"end":{"line":19,"column":35,"offset":472},"indent":[]}}],"position":{"start":{"line":18,"column":1,"offset":376},"end":{"line":19,"column":35,"offset":472},"indent":[1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"로그 변환","position":{"start":{"line":21,"column":5,"offset":478},"end":{"line":21,"column":10,"offset":483},"indent":[]}}],"position":{"start":{"line":21,"column":1,"offset":474},"end":{"line":21,"column":10,"offset":483},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"입력 벡터의 구성요소가 많아질수록 조건부확률이 너무 작아져서 비교가 불가능한 Underflow 현상 발생","position":{"start":{"line":23,"column":3,"offset":487},"end":{"line":23,"column":61,"offset":545},"indent":[]}}],"position":{"start":{"line":23,"column":3,"offset":487},"end":{"line":23,"column":61,"offset":545},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":485},"end":{"line":23,"column":61,"offset":545},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"이를 예방하기 위해 조건부확률 계산식에 log를 적용","position":{"start":{"line":24,"column":3,"offset":548},"end":{"line":24,"column":32,"offset":577},"indent":[]}}],"position":{"start":{"line":24,"column":3,"offset":548},"end":{"line":24,"column":32,"offset":577},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":546},"end":{"line":24,"column":32,"offset":577},"indent":[]}}],"position":{"start":{"line":23,"column":1,"offset":485},"end":{"line":24,"column":32,"offset":577},"indent":[1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"실습","position":{"start":{"line":27,"column":5,"offset":584},"end":{"line":27,"column":7,"offset":586},"indent":[]}}],"position":{"start":{"line":27,"column":1,"offset":580},"end":{"line":27,"column":7,"offset":586},"indent":[]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"패키지 로드","position":{"start":{"line":29,"column":6,"offset":593},"end":{"line":29,"column":12,"offset":599},"indent":[]}}],"position":{"start":{"line":29,"column":1,"offset":588},"end":{"line":29,"column":12,"offset":599},"indent":[]}},{"type":"code","lang":"python","meta":null,"value":"from sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import GaussianNB\nimport pandas as pd\nimport numpy as np","position":{"start":{"line":32,"column":1,"offset":602},"end":{"line":37,"column":4,"offset":750},"indent":[1,1,1,1,1]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"데이터 로드","position":{"start":{"line":39,"column":6,"offset":757},"end":{"line":39,"column":12,"offset":763},"indent":[]}}],"position":{"start":{"line":39,"column":1,"offset":752},"end":{"line":39,"column":12,"offset":763},"indent":[]}},{"type":"code","lang":"python","meta":null,"value":"tennis_data = pd.read_csv('./playtennis.csv')\ntennis_data","position":{"start":{"line":42,"column":1,"offset":766},"end":{"line":45,"column":4,"offset":837},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"link","title":null,"url":"/파이썬을-이용한-빅데이터-분석-ch-4-의사결정트리","children":[{"type":"text","value":"ch4 의사결정트리","position":{"start":{"line":46,"column":2,"offset":839},"end":{"line":46,"column":12,"offset":849},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":838},"end":{"line":46,"column":44,"offset":881},"indent":[]}},{"type":"text","value":"와 동일한 데이터","position":{"start":{"line":46,"column":44,"offset":881},"end":{"line":46,"column":53,"offset":890},"indent":[]}}],"position":{"start":{"line":46,"column":1,"offset":838},"end":{"line":46,"column":53,"offset":890},"indent":[]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"데이터 분리","position":{"start":{"line":48,"column":6,"offset":897},"end":{"line":48,"column":12,"offset":903},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":892},"end":{"line":48,"column":12,"offset":903},"indent":[]}},{"type":"code","lang":"python","meta":null,"value":"X = np.array(pd.DataFrame(tennis_data,columns=['Outlook','Temperature','Humidity','Wind']))\ny = np.array(pd.DataFrame(tennis_data,columns=['PlayTennis']))","position":{"start":{"line":51,"column":1,"offset":906},"end":{"line":54,"column":4,"offset":1074},"indent":[1,1,1]}},{"type":"code","lang":"python","meta":null,"value":"X_train,X_test,y_train,y_test = train_test_split(X,y)","position":{"start":{"line":57,"column":1,"offset":1077},"end":{"line":59,"column":4,"offset":1144},"indent":[1,1]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"나이브 베이즈 모델 생성","position":{"start":{"line":61,"column":6,"offset":1151},"end":{"line":61,"column":19,"offset":1164},"indent":[]}}],"position":{"start":{"line":61,"column":1,"offset":1146},"end":{"line":61,"column":19,"offset":1164},"indent":[]}},{"type":"code","lang":"python","meta":null,"value":"gnb_clf = GaussianNB()\ngnb_clf = gnb_clf.fit(X_train,y_train.ravel())","position":{"start":{"line":64,"column":1,"offset":1167},"end":{"line":67,"column":4,"offset":1250},"indent":[1,1,1]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"클래스 예측","position":{"start":{"line":69,"column":6,"offset":1257},"end":{"line":69,"column":12,"offset":1263},"indent":[]}}],"position":{"start":{"line":69,"column":1,"offset":1252},"end":{"line":69,"column":12,"offset":1263},"indent":[]}},{"type":"code","lang":"python","meta":null,"value":"gnb_prediction = gnb_clf.predict(X_test)","position":{"start":{"line":72,"column":1,"offset":1266},"end":{"line":74,"column":4,"offset":1320},"indent":[1,1]}},{"type":"code","lang":"python","meta":null,"value":"print('X_test\\n',X_test)\nprint('y_test\\n',gnb_prediction)","position":{"start":{"line":77,"column":1,"offset":1323},"end":{"line":80,"column":4,"offset":1394},"indent":[1,1,1]}},{"type":"code","lang":null,"meta":null,"value":"X_test\n [[2 5 7 9]\n [0 4 7 9]\n [1 4 6 9]\n [1 5 7 9]]\ny_test\n [11 10 10 11]","position":{"start":{"line":82,"column":1,"offset":1396},"end":{"line":88,"column":19,"offset":1498},"indent":[1,1,1,1,1,1]}},{"type":"heading","depth":4,"children":[{"type":"text","value":"분류성능측정","position":{"start":{"line":91,"column":6,"offset":1506},"end":{"line":91,"column":12,"offset":1512},"indent":[]}}],"position":{"start":{"line":91,"column":1,"offset":1501},"end":{"line":91,"column":12,"offset":1512},"indent":[]}},{"type":"code","lang":"python","meta":null,"value":"from sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import accuracy_score","position":{"start":{"line":94,"column":1,"offset":1515},"end":{"line":99,"column":4,"offset":1703},"indent":[1,1,1,1,1]}},{"type":"code","lang":"python","meta":null,"value":"print('Confusion Matrix')\nprint(confusion_matrix(y_test,gnb_prediction))","position":{"start":{"line":102,"column":1,"offset":1706},"end":{"line":105,"column":4,"offset":1792},"indent":[1,1,1]}},{"type":"code","lang":null,"meta":null,"value":"Confusion Matrix\n[[0 1]\n [2 1]]","position":{"start":{"line":107,"column":1,"offset":1794},"end":{"line":109,"column":12,"offset":1837},"indent":[1,1]}},{"type":"code","lang":"python","meta":null,"value":"print('Classification Report')\nprint(classification_report(y_test,gnb_prediction))","position":{"start":{"line":113,"column":1,"offset":1841},"end":{"line":116,"column":4,"offset":1937},"indent":[1,1,1]}},{"type":"code","lang":null,"meta":null,"value":"Classification Report\n              precision    recall  f1-score   support\n\n          10       0.00      0.00      0.00         1\n          11       0.50      0.33      0.40         3\n\n    accuracy                           0.25         4\n   macro avg       0.25      0.17      0.20         4\nweighted avg       0.38      0.25      0.30         4","position":{"start":{"line":118,"column":1,"offset":1939},"end":{"line":127,"column":5,"offset":2327},"indent":[1,1,1,1,1,1,1,1,1]}},{"type":"code","lang":"python","meta":null,"value":"fmeasure = round(f1_score(y_test,gnb_prediction,average='weighted'),2)\naccuracy = round(accuracy_score(y_test,gnb_prediction,normalize=True),2)","position":{"start":{"line":131,"column":1,"offset":2331},"end":{"line":134,"column":4,"offset":2488},"indent":[1,1,1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"<파이썬을 이용한 빅데이터 분석> ch7 나이브베이즈\",\"date\":\"2020-08-15T00:00:00.000Z\",\"tags\":[\"Python\",\"BigData\",\"MachineLearning\"]}","position":{"start":{"line":137,"column":1,"offset":2491},"end":{"line":137,"column":150,"offset":2640},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":137,"column":150,"offset":2640}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"<파이썬을 이용한 빅데이터 분석> ch7 나이브베이즈\",\n  \"date\": \"2020-08-15T00:00:00.000Z\",\n  \"tags\": [\"Python\", \"BigData\", \"MachineLearning\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component '\" + name + \"' was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"\\uBD84\\uB958\\uB97C \\uBAA9\\uC801\\uC73C\\uB85C \\uD558\\uB294 \\uC9C0\\uB3C4\\uD559\\uC2B5\\uC758 \\uC77C\\uC885\"), mdx(\"h3\", null, \"\\uBCA0\\uC774\\uC988 \\uC815\\uB9AC\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uB450 \\uD655\\uB960 \\uBCC0\\uC218\\uC758 \\uC0AC\\uC804\\uD655\\uB960\\uACFC \\uC0AC\\uD6C4 \\uD655\\uB960 \\uC0AC\\uC774\\uC758 \\uAD00\\uACC4\\uB97C \\uB098\\uD0C0\\uB0B4\\uB294 \\uC815\\uB9AC\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uC0AC\\uC804 \\uD655\\uB960 \\uC815\\uBCF4\\uB97C \\uC774\\uC6A9\\uD574 \\uC0AC\\uD6C4 \\uD655\\uB960\\uC744 \\uCD94\\uC815\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"\\uC0AC\\uC804\\uD655\\uB960\"), \" : \\uAC00\\uC9C0\\uACE0 \\uC788\\uB294 \\uC815\\uBCF4\\uB97C \\uAE30\\uCD08\\uB85C \\uC815\\uD55C \\uCD08\\uAE30 \\uD655\\uB960.\", mdx(\"ul\", {\n    parentName: \"li\"\n  }, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"A : \\uC0AC\\uAC74\\uC758 \\uC6D0\\uC778, B : \\uACB0\\uACFC, P(A) : \\uC6D0\\uC778\\uC758 \\uC0AC\\uC804\\uD655\\uB960, P(B) : \\uACB0\\uACFC\\uC758 \\uC0AC\\uC804\\uD655\\uB960\"))), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"\\uC0AC\\uD6C4\\uD655\\uB960\"), \" : \\uACB0\\uACFC\\uAC00 \\uBC1C\\uC0DD\\uD588\\uB2E4\\uB294 \\uC870\\uAC74\\uC5D0\\uC11C \\uC5B4\\uB5A4 \\uC6D0\\uC778\\uC774 \\uBC1C\\uC0DD\\uD588\\uC744 \\uD655\\uB960. P(A|B)\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"\\uC6B0\\uB3C4\"), \" : \\uC6D0\\uC778\\uC774 \\uBC1C\\uC0DD\\uD588\\uB2E4\\uB294 \\uC870\\uAC74\\uC5D0\\uC11C \\uACB0\\uACFC\\uAC00 \\uBC1C\\uC0DD\\uD588\\uC744 \\uD655\\uB960. P(B|A)\")))), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"44.99999999999999%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/ElEQVQoz31RiW6DMBTj//9u7bSOVisQClUhHOEKhMPLi8RUrj3JekSyjO1nYTXTNP3ttm0NhmFAmiYaqUFVVQvu+1hrkfmbRMIggM8YyrKAyHPY9jdc10HXdRv+vK21s/+GhJRSOEq167Dve+OOMI6jfiuDWYg4JEy8mbtxOD+U6hCGAXgcI4peuqsSvs/wePhgzEMcRygKgfv9B89nCE/HT5NkX3Dd414FR7VsIh+R67rWBynNVYUQJl7TNMallA2yLFscaBOZOvE811ySRDiPcbl84Xz6gOs4RpxzjuvVxuf5hJveVMuhIO33g9BIKZHn2cI5/ZiE99L9Apgrv6/aahgnAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"베이즈정리\",\n    \"title\": \"베이즈정리\",\n    \"src\": \"/static/837b76ddfab219196b6ad74e0a435b61/7d769/ch7.png\",\n    \"srcSet\": [\"/static/837b76ddfab219196b6ad74e0a435b61/5243c/ch7.png 240w\", \"/static/837b76ddfab219196b6ad74e0a435b61/ab158/ch7.png 480w\", \"/static/837b76ddfab219196b6ad74e0a435b61/7d769/ch7.png 960w\", \"/static/837b76ddfab219196b6ad74e0a435b61/94f3c/ch7.png 1116w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"h3\", null, \"\\uB77C\\uD50C\\uB77C\\uC2A4 \\uC2A4\\uBB34\\uB529\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uB098\\uC774\\uBE0C \\uBCA0\\uC774\\uC988 \\uBD84\\uB958\\uAE30\\uC5D0\\uC11C \\uD559\\uC2B5\\uB418\\uC9C0 \\uC54A\\uC740 \\uC0C8\\uB85C\\uC6B4 \\uC785\\uB825 \\uBCA1\\uD130\\uAC00 \\uC785\\uB825\\uB420 \\uACBD\\uC6B0 \\uC870\\uAC74\\uBD80 \\uD655\\uB960\\uC774 0\\uC774 \\uB418\\uB294 \\uBB38\\uC81C \\uBC1C\\uC0DD\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uC774 \\uBB38\\uC81C\\uB97C \\uD574\\uACB0\\uD558\\uAE30 \\uC704\\uD574 \\uD655\\uB960\\uAC12\\uC744 \\uBCF4\\uC815\\uD558\\uB294\\uB370 \\uC0AC\\uC6A9\\uD558\\uB294 \\uAE30\\uBC95\")), mdx(\"h3\", null, \"\\uB85C\\uADF8 \\uBCC0\\uD658\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uC785\\uB825 \\uBCA1\\uD130\\uC758 \\uAD6C\\uC131\\uC694\\uC18C\\uAC00 \\uB9CE\\uC544\\uC9C8\\uC218\\uB85D \\uC870\\uAC74\\uBD80\\uD655\\uB960\\uC774 \\uB108\\uBB34 \\uC791\\uC544\\uC838\\uC11C \\uBE44\\uAD50\\uAC00 \\uBD88\\uAC00\\uB2A5\\uD55C Underflow \\uD604\\uC0C1 \\uBC1C\\uC0DD\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uC774\\uB97C \\uC608\\uBC29\\uD558\\uAE30 \\uC704\\uD574 \\uC870\\uAC74\\uBD80\\uD655\\uB960 \\uACC4\\uC0B0\\uC2DD\\uC5D0 log\\uB97C \\uC801\\uC6A9\")), mdx(\"h3\", null, \"\\uC2E4\\uC2B5\"), mdx(\"h4\", null, \"\\uD328\\uD0A4\\uC9C0 \\uB85C\\uB4DC\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"from sklearn.model_selection import train_test_split\\nfrom sklearn.naive_bayes import GaussianNB\\nimport pandas as pd\\nimport numpy as np\\n\")), mdx(\"h4\", null, \"\\uB370\\uC774\\uD130 \\uB85C\\uB4DC\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"tennis_data = pd.read_csv('./playtennis.csv')\\ntennis_data\\n\")), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%B9%85%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D-ch-4-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%ED%8A%B8%EB%A6%AC\"\n  }), \"ch4 \\uC758\\uC0AC\\uACB0\\uC815\\uD2B8\\uB9AC\"), \"\\uC640 \\uB3D9\\uC77C\\uD55C \\uB370\\uC774\\uD130\"), mdx(\"h4\", null, \"\\uB370\\uC774\\uD130 \\uBD84\\uB9AC\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"X = np.array(pd.DataFrame(tennis_data,columns=['Outlook','Temperature','Humidity','Wind']))\\ny = np.array(pd.DataFrame(tennis_data,columns=['PlayTennis']))\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"X_train,X_test,y_train,y_test = train_test_split(X,y)\\n\")), mdx(\"h4\", null, \"\\uB098\\uC774\\uBE0C \\uBCA0\\uC774\\uC988 \\uBAA8\\uB378 \\uC0DD\\uC131\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"gnb_clf = GaussianNB()\\ngnb_clf = gnb_clf.fit(X_train,y_train.ravel())\\n\")), mdx(\"h4\", null, \"\\uD074\\uB798\\uC2A4 \\uC608\\uCE21\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"gnb_prediction = gnb_clf.predict(X_test)\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"print('X_test\\\\n',X_test)\\nprint('y_test\\\\n',gnb_prediction)\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"X_test\\n [[2 5 7 9]\\n [0 4 7 9]\\n [1 4 6 9]\\n [1 5 7 9]]\\ny_test\\n [11 10 10 11]\\n\")), mdx(\"h4\", null, \"\\uBD84\\uB958\\uC131\\uB2A5\\uCE21\\uC815\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"from sklearn.metrics import confusion_matrix\\nfrom sklearn.metrics import classification_report\\nfrom sklearn.metrics import f1_score\\nfrom sklearn.metrics import accuracy_score\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"print('Confusion Matrix')\\nprint(confusion_matrix(y_test,gnb_prediction))\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"Confusion Matrix\\n[[0 1]\\n [2 1]]\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"print('Classification Report')\\nprint(classification_report(y_test,gnb_prediction))\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"Classification Report\\n              precision    recall  f1-score   support\\n\\n          10       0.00      0.00      0.00         1\\n          11       0.50      0.33      0.40         3\\n\\n    accuracy                           0.25         4\\n   macro avg       0.25      0.17      0.20         4\\nweighted avg       0.38      0.25      0.30         4\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"fmeasure = round(f1_score(y_test,gnb_prediction,average='weighted'),2)\\naccuracy = round(accuracy_score(y_test,gnb_prediction,normalize=True),2)\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"<파이썬을 이용한 빅데이터 분석> ch7 나이브베이즈\",\n  \"date\": \"2020-08-15T00:00:00.000Z\",\n  \"tags\": [\"Python\", \"BigData\", \"MachineLearning\"]\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component '\" + name + \"' was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <p>{`분류를 목적으로 하는 지도학습의 일종`}</p>\n    <h3>{`베이즈 정리`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`두 확률 변수의 사전확률과 사후 확률 사이의 관계를 나타내는 정리`}<ul parentName=\"li\">\n          <li parentName=\"ul\">{`사전 확률 정보를 이용해 사후 확률을 추정`}</li>\n          <li parentName=\"ul\"><strong parentName=\"li\">{`사전확률`}</strong>{` : 가지고 있는 정보를 기초로 정한 초기 확률.`}<ul parentName=\"li\">\n              <li parentName=\"ul\">{`A : 사건의 원인, B : 결과, P(A) : 원인의 사전확률, P(B) : 결과의 사전확률`}</li>\n            </ul></li>\n          <li parentName=\"ul\"><strong parentName=\"li\">{`사후확률`}</strong>{` : 결과가 발생했다는 조건에서 어떤 원인이 발생했을 확률. P(A|B)`}</li>\n          <li parentName=\"ul\"><strong parentName=\"li\">{`우도`}</strong>{` : 원인이 발생했다는 조건에서 결과가 발생했을 확률. P(B|A)`}</li>\n        </ul></li>\n    </ul>\n    <p><span parentName=\"p\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"960px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"44.99999999999999%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAA/ElEQVQoz31RiW6DMBTj//9u7bSOVisQClUhHOEKhMPLi8RUrj3JekSyjO1nYTXTNP3ttm0NhmFAmiYaqUFVVQvu+1hrkfmbRMIggM8YyrKAyHPY9jdc10HXdRv+vK21s/+GhJRSOEq167Dve+OOMI6jfiuDWYg4JEy8mbtxOD+U6hCGAXgcI4peuqsSvs/wePhgzEMcRygKgfv9B89nCE/HT5NkX3Dd414FR7VsIh+R67rWBynNVYUQJl7TNMallA2yLFscaBOZOvE811ySRDiPcbl84Xz6gOs4RpxzjuvVxuf5hJveVMuhIO33g9BIKZHn2cI5/ZiE99L9Apgrv6/aahgnAAAAAElFTkSuQmCC')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<img parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-image\",\n          \"alt\": \"베이즈정리\",\n          \"title\": \"베이즈정리\",\n          \"src\": \"/static/837b76ddfab219196b6ad74e0a435b61/7d769/ch7.png\",\n          \"srcSet\": [\"/static/837b76ddfab219196b6ad74e0a435b61/5243c/ch7.png 240w\", \"/static/837b76ddfab219196b6ad74e0a435b61/ab158/ch7.png 480w\", \"/static/837b76ddfab219196b6ad74e0a435b61/7d769/ch7.png 960w\", \"/static/837b76ddfab219196b6ad74e0a435b61/94f3c/ch7.png 1116w\"],\n          \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n          \"style\": {\n            \"width\": \"100%\",\n            \"height\": \"100%\",\n            \"margin\": \"0\",\n            \"verticalAlign\": \"middle\",\n            \"position\": \"absolute\",\n            \"top\": \"0\",\n            \"left\": \"0\"\n          },\n          \"loading\": \"lazy\"\n        }}></img>{`\n    `}</span></p>\n    <h3>{`라플라스 스무딩`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`나이브 베이즈 분류기에서 학습되지 않은 새로운 입력 벡터가 입력될 경우 조건부 확률이 0이 되는 문제 발생`}</li>\n      <li parentName=\"ul\">{`이 문제를 해결하기 위해 확률값을 보정하는데 사용하는 기법`}</li>\n    </ul>\n    <h3>{`로그 변환`}</h3>\n    <ul>\n      <li parentName=\"ul\">{`입력 벡터의 구성요소가 많아질수록 조건부확률이 너무 작아져서 비교가 불가능한 Underflow 현상 발생`}</li>\n      <li parentName=\"ul\">{`이를 예방하기 위해 조건부확률 계산식에 log를 적용`}</li>\n    </ul>\n    <h3>{`실습`}</h3>\n    <h4>{`패키지 로드`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`from sklearn.model_selection import train_test_split\nfrom sklearn.naive_bayes import GaussianNB\nimport pandas as pd\nimport numpy as np\n`}</code></pre>\n    <h4>{`데이터 로드`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`tennis_data = pd.read_csv('./playtennis.csv')\ntennis_data\n`}</code></pre>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"/%ED%8C%8C%EC%9D%B4%EC%8D%AC%EC%9D%84-%EC%9D%B4%EC%9A%A9%ED%95%9C-%EB%B9%85%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D-ch-4-%EC%9D%98%EC%82%AC%EA%B2%B0%EC%A0%95%ED%8A%B8%EB%A6%AC\"\n      }}>{`ch4 의사결정트리`}</a>{`와 동일한 데이터`}</p>\n    <h4>{`데이터 분리`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`X = np.array(pd.DataFrame(tennis_data,columns=['Outlook','Temperature','Humidity','Wind']))\ny = np.array(pd.DataFrame(tennis_data,columns=['PlayTennis']))\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`X_train,X_test,y_train,y_test = train_test_split(X,y)\n`}</code></pre>\n    <h4>{`나이브 베이즈 모델 생성`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`gnb_clf = GaussianNB()\ngnb_clf = gnb_clf.fit(X_train,y_train.ravel())\n`}</code></pre>\n    <h4>{`클래스 예측`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`gnb_prediction = gnb_clf.predict(X_test)\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`print('X_test\\\\n',X_test)\nprint('y_test\\\\n',gnb_prediction)\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{}}>{`X_test\n [[2 5 7 9]\n [0 4 7 9]\n [1 4 6 9]\n [1 5 7 9]]\ny_test\n [11 10 10 11]\n`}</code></pre>\n    <h4>{`분류성능측정`}</h4>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`from sklearn.metrics import confusion_matrix\nfrom sklearn.metrics import classification_report\nfrom sklearn.metrics import f1_score\nfrom sklearn.metrics import accuracy_score\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`print('Confusion Matrix')\nprint(confusion_matrix(y_test,gnb_prediction))\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{}}>{`Confusion Matrix\n[[0 1]\n [2 1]]\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`print('Classification Report')\nprint(classification_report(y_test,gnb_prediction))\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{}}>{`Classification Report\n              precision    recall  f1-score   support\n\n          10       0.00      0.00      0.00         1\n          11       0.50      0.33      0.40         3\n\n    accuracy                           0.25         4\n   macro avg       0.25      0.17      0.20         4\nweighted avg       0.38      0.25      0.30         4\n`}</code></pre>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-python\"\n      }}>{`fmeasure = round(f1_score(y_test,gnb_prediction,average='weighted'),2)\naccuracy = round(accuracy_score(y_test,gnb_prediction,normalize=True),2)\n`}</code></pre>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}