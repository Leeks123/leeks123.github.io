{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/파이썬을-이용한-빅데이터-분석-ch-10-knn","result":{"data":{"post":{"__typename":"MdxPost","slug":"/파이썬을-이용한-빅데이터-분석-ch-10-knn","title":"<파이썬을 이용한 빅데이터 분석> ch10 KNN","date":"24.08.2020","tags":[{"name":"Python","slug":"python"},{"name":"BigData","slug":"big-data"},{"name":"MachineLearning","slug":"machine-learning"}],"description":null,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"<파이썬을 이용한 빅데이터 분석> ch10 KNN\",\n  \"date\": \"2020-08-24T00:00:00.000Z\",\n  \"tags\": [\"Python\", \"BigData\", \"MachineLearning\"]\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component '\" + name + \"' was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h3\", null, \"KNN\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uC9C0\\uB3C4\\uD559\\uC2B5, \\uBD84\\uB958 \\uC54C\\uACE0\\uB9AC\\uC998\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uC8FC\\uC5B4\\uC9C4 \\uB370\\uC774\\uD130\\uB85C\\uBD80\\uD130 \\uAC70\\uB9AC\\uAC00 \\uAC00\\uAE4C\\uC6B4 k\\uAC1C\\uC758 \\uB2E4\\uB978 \\uB370\\uC774\\uD130\\uB4E4\\uC758 \\uB77C\\uBCA8 \\uC911 \\uAC00\\uC7A5 \\uB9CE\\uC740 \\uBE44\\uC728\\uC744 \\uCC28\\uC9C0\\uD558\\uB294 \\uB77C\\uBCA8\\uC744 \\uCC38\\uC870\\uD558\\uC5EC \\uBD84\\uB958\\uD558\\uB294 \\uC54C\\uACE0\\uB9AC\\uC998\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uC0AC\\uB840 \\uAE30\\uBC18 \\uC54C\\uACE0\\uB9AC\\uC998\\uC758 \\uD55C \\uC885\\uB958\\uB85C \\uB370\\uC774\\uD130 \\uC591\\uC774 \\uB9CE\\uC544\\uC9C0\\uBA74 \\uC18D\\uB3C4\\uAC00 \\uB290\\uB824\\uC9C8 \\uC218 \\uC788\\uC74C\")), mdx(\"h4\", null, \"K \\uAC1C\\uC218 \\uCD5C\\uC801\\uD654 \\uBB38\\uC81C\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"k\\uAC12\\uC774 \\uD074 \\uB54C \\uC804\\uCCB4\\uC801\\uC778 \\uB178\\uC774\\uC988\\uB97C \\uC904\\uC77C \\uC218 \\uC788\\uC9C0\\uB9CC \\uC911\\uC694\\uD55C \\uD328\\uD134\\uC744 \\uBB34\\uC2DC\\uD560 \\uAC00\\uB2A5\\uC131\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\uCD5C\\uC801\\uC758 K\\uAC12\\uC744 \\uCC3E\\uAE30 \\uC704\\uD574 K-fold Cross-validation \\uBC29\\uBC95\\uC744 \\uD65C\\uC6A9\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"k=1\\uC77C \\uB54C \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"over-fitting\"), \" \\uB420 \\uC218 \\uC788\\uC74C\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"k\\uAC12\\uC774 \\uB108\\uBB34 \\uD074 \\uB54C \\uC0C8\\uB85C\\uC6B4 \\uB370\\uC774\\uD130\\uC758 \\uB77C\\uBCA8\\uC740 \\uD56D\\uC0C1 \\uC804\\uCCB4 \\uB370\\uC774\\uD130\\uC758 \\uB300\\uB2E4\\uC218\\uB97C \\uCC28\\uC9C0\\uD558\\uB294 \\uB77C\\uBCA8\\uB85C \\uBD84\\uB958\\uD558\\uB294 \", mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"under fitting\"), \" \\uBB38\\uC81C \\uBC1C\\uC0DD\")), mdx(\"hr\", null), mdx(\"h3\", null, \"KNN \\uC2E4\\uC2B5\"), mdx(\"h4\", null, \"\\uD328\\uD0A4\\uC9C0 , \\uB370\\uC774\\uD130 \\uB85C\\uB4DC\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"from sklearn.neighbors import KNeighborsClassifier\\nfrom sklearn.metrics import accuracy_score\\nfrom sklearn.model_selection import train_test_split\\nfrom sklearn.model_selection import cross_val_score\\n\\nimport pandas as pd\\nimport numpy as np\\n\\nfrom sklearn.datasets import load_breast_cancer\\nfrom sklearn.preprocessing import normalize\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"breast_cancer = load_breast_cancer()\\nX = breast_cancer.data\\ny = breast_cancer.target\\n\\ndf = pd.DataFrame(X,columns = breast_cancer.feature_names)\\n\")), mdx(\"h4\", null, \"\\uB370\\uC774\\uD130 \\uC14B \\uBD84\\uB9AC\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"X_train, X_test, y_train, y_test = train_test_split(X,y,test_size=0.33, random_state = 42)\\n\")), mdx(\"h4\", null, \"\\uBAA8\\uB378 \\uD559\\uC2B5 \\uBC0F \\uC815\\uD655\\uB3C4 \\uCE21\\uC815\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"estimator = KNeighborsClassifier(n_neighbors=5, weights = 'distance')\\n\\nestimator.fit(X_train,y_train)\\n\\nlabel_predict = estimator.predict(X_test)\\n\\nprint(\\\"The accuracy score of classification: %.9f\\\"%accuracy_score(y_test,label_predict))\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"The accuracy score of classification: 0.941489362\\n\")), mdx(\"h4\", null, \"Cross Validation\\uBC29\\uBC95\\uC744 \\uC0AC\\uC6A9\\uD558\\uC5EC \\uCD5C\\uC801\\uC758 k\\uAC12\\uC744 \\uCC3E\\uAE30\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"myList = list(range(1,100))\\nneighbors = [ x for x in myList if x%2!=0]\\nprint(\\\"k\\uC758 \\uD6C4\\uBCF4\\uAC12\\uB4E4 \\uCD94\\uCD9C\\\",neighbors)\\ncv_scores = []\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"k\\uC758 \\uD6C4\\uBCF4\\uAC12\\uB4E4 \\uCD94\\uCD9C [1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23, 25, 27, 29, 31, 33, 35, 37, 39, 41, 43, 45, 47, 49, 51, 53, 55, 57, 59, 61, 63, 65, 67, 69, 71, 73, 75, 77, 79, 81, 83, 85, 87, 89, 91, 93, 95, 97, 99]\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"for k in neighbors:\\n    print(\\\"< k = %d >\\\"%k)\\n    estimator = KNeighborsClassifier(n_neighbors=k)\\n    scores = cross_val_score(estimator, X_train, y_train, cv=10,scoring=\\\"accuracy\\\")\\n    print(\\\"The scores of classification are \\\\n\\\"+str(scores))\\n    cv_scores.append(scores.mean())\\n    print(\\\"The average score of score is %.9f \\\\n\\\"%scores.mean())\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"< k = 1 >\\nThe scores of classification are \\n[0.97435897 0.84210526 0.92105263 0.97368421 0.81578947 0.89473684\\n 0.89473684 0.89473684 0.89473684 0.84210526]\\nThe average score of score is 0.894804318 \\n\\n< k = 3 >\\nThe scores of classification are \\n[0.94871795 0.86842105 0.89473684 0.94736842 0.94736842 0.89473684\\n 0.86842105 0.89473684 0.94736842 0.81578947]\\nThe average score of score is 0.902766532 \\n\\n< k = 5 >\\nThe scores of classification are \\n[0.94871795 0.86842105 0.89473684 0.94736842 0.94736842 0.92105263\\n 0.94736842 0.86842105 0.92105263 0.81578947]\\nThe average score of score is 0.908029690 \\n\\n...\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"MSE = [1 - x for x in cv_scores]\\n\\nplt.plot(neighbors, MSE)\\nplt.xlabel(\\\"Number of Neighbors K\\\")\\nplt.ylabel(\\\"Misclassification Error\\\")\\nplt.show()\\n\\nmin_MSE = min(MSE)\\nindex_of_min_MSE = MSE.index(min_MSE)\\noptimal_k = neighbors[index_of_min_MSE]\\nprint(\\\"The optimal number of neighbors i is %d\\\"%optimal_k)\\n\")), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"398px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"65.83333333333333%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsSAAALEgHS3X78AAACJElEQVQ4y52Tz2sTQRTHR6soShOC8SBC78UfqCf/DosKRQ/F/jceQpJTLkFUME1EcsjJhAoi2kBI0lP8leBqU7bJ/t6d/TXZGd9sNttFDBUffJk3b5cP7ztvBhUKhVMIodPlcnlNFMUXqqrWZFneURSlygV5vOqqWj2aStWJJMU1cSJVP/84rEiy8kYQhKcon8+vAPBspVK5HQQBOykcEEnsTcrYF3lesS3zOxqPx2GHtVrthuu6OtQphA8iSc2CgPyUMREki4xVmzj+jNgeIZLpEmjEN33KFFXromw2exmAZ+r1+nXP8zCLiNHKopT9UjATdScUgNnEcNmBYjPZcvnn0BoA91E6nb4KwHO16s5NbDshMCQmYLOAMhV7sU0Owx5hiuUxw/FjoK7r+yiVSq3xDj/svr021Sw8ozEyBpoOgU6OgYt6Yg2BmqbFwAuvX728JenYwv7cbXIQX0UjhC6B/RW48vH9u3XVxNaB5nIrFA6dWS4JrSqR3T8gSR0DM5nMFQCuPn9WvmNgxzrUXSbIFoVp0qnpUpgkhQnT6FyXxQLYR4toNpvrvufpgmIH3474JQivG5fPTs69aChdlMvl+MVeLRaLdwmZn5M5Y/8V8MqGqNVqhR2WSqV0p9N5NJ1MHsrS9P6nvb3t0Wi0CTY22u32k+FwuGma5r1ut7s1GAweG4ax0ev1tvie1/v9/naj0XiA/jGy/HmCzoMugS4u+/E3q0crOwiO0/IAAAAASUVORK5CYII=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"png\",\n    \"title\": \"png\",\n    \"src\": \"/static/f715c329e1cf56f8e36d6f99890f4564/48cfd/ch10_25_0.png\",\n    \"srcSet\": [\"/static/f715c329e1cf56f8e36d6f99890f4564/5243c/ch10_25_0.png 240w\", \"/static/f715c329e1cf56f8e36d6f99890f4564/48cfd/ch10_25_0.png 398w\"],\n    \"sizes\": \"(max-width: 398px) 100vw, 398px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n    \")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"The optimal number of neighbors i is 13\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-python\"\n  }), \"estimator = KNeighborsClassifier(n_neighbors =13)\\nestimator.fit(X_train,y_train)\\n\\nlabel_predict = estimator.predict(X_test)\\n\\nprint(\\\"accuracy: %.9f\\\"%accuracy_score(y_test, label_predict))\\n\")), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"accuracy: 0.962765957\\n\")));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"KNN 지도학습, 분류 알고리즘 주어진 데이터로부터 거리가 가까운 k개의 다른 데이터들의 라벨 중 가장 많은 비율을 차지하는 라벨을 참조하여 분류하는 알고리즘 사례 기반 알고리즘의 한 종류로 데이터 양이 많아지면 속도가 느려질 수 있음 K…","timeToRead":1,"banner":null}},"pageContext":{"slug":"/파이썬을-이용한-빅데이터-분석-ch-10-knn","formatString":"DD.MM.YYYY"}},"staticQueryHashes":["318001574","3787687951","3787687951"]}