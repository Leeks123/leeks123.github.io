---
title: <파이썬을 이용한 빅데이터 분석> ch2 기계학습을 이용한 데이터분석
date: 2020-08-05
tags:
  - Python
  - BigData
  - MachineLearning
---


### 기계학습의 종류

- 지도 학습
    - 학습 데이터의 정확한 클래스가 알려저 있음
    - 학습 알고리즘은 사람이 수작업으로 클래스를 입력한 데이터에 의존
    - 결과를 수동으로 사람이 검토할 필요가 없음

    → 문제와 답을 주고 가르치는 방식

- 비지도 학습
    - 학습데이터의 정확한 클래스가 알려져 있지 않음
    - 학습 알고리즘은 원시 데이터에 의존함
    - 결과를 사람이 검토해야 하는데 막대한 비용이 발생
- 준지도 학습
    - 지도 학습과 비지도 학습을 섞은 모델
    - 사람이 수작업으로 클래스를 입력한 데이터에 의존한 분석
    - 모델의 결과를 자동으로 분석
- 강화 학습
    - 기계 또는 소프트웨어 에이전트는 환경으로부터의 피드백을 기반으로 동작을 학습
    - 알고리즘은 사람의 입력에 의해 지속적으로 훈련되고 자동으로 정확도를 높임

    → 실패를 하면 그 상황에 대한 피드백을, 성공을 하면 보상을 주는 방식

---

### 기계학습 기술

1. 분류 (Classification)
    - 데이터로부터 클래스를 예측하는 것. 미리 정의된 카테고리로 데이터를 분류.
    - 대표적 알고리즘 : 나이브 베이즈, 랜덤 포레스트, 서포트 벡터 머신
2. 군집 (Clustering)
    - 서로 더 비슷한 개체 집합을 동일한 그룹으로 그룹화하는 것
    - 개체는 사전에 미리 정의되어 있지 않음
    - 대표적 알고리즘 : K-means 군집, 계층적 군집
3. 회귀 (Regression)
    - 회귀는 하나의 변수 평균 값과 다른 변수의 해당 값 간의 관계를 측정한 것
    - 학습데이터를 이용해 결과 값을 예측하는 것
    - 대표적으로 로지스틱 회귀, 선형 회귀

---

### 예측모델 성능 평가

1. 데이터 셋 구성 방법
- Holdout
    - 가장 단순한 데이터 분할 방법으로 Train Set, Test Set 두 셋으로 나눈다. 
    - 이 때의 두 데이터 셋의 비율을 일정하게 설정해야 한다. 
    - Train Set이 작으면 모델 정확도의 분산이 커지고, Train Set이 커지면 Test Set으로부터 측정한 정확도의 신뢰도가 하락한다.
- Random Subsampling
    - Holdout 방식을 반복하는 방법
    - k개의 부분 데이터 셋을 무작위로 추출해서 데이터셋을 나누고, 성능을 측정한다. 
    - 이 측정은 여러번 진행되고 최종 성능은 여러번 진행된 측정의 평균으로 도출된다.
- K-fold Cross Validation
    - 데이터셋을 k개의 fold로 나눠 사용한다. k번의 실험을 진행하며 각 실험에서 1개의 폴드(테스트셋)과 나머지 폴드(훈련셋)을 이용한다.
    - Random Subsampling과 달리 전체 데이터를 Train과 Test에 적용할 수 있다
    - 최종 성능은 k번의 실험 성능의 평균으로 도출
- Stratified Sampling
    - 층별 표집 방법. 
    - 데이터를 클래스에 따라 각 그룹으로 분리 후, 각 그룹으로 부터 일정 비율의 샘플을 무작위 추출하는 방법. 
    - 표본이 특정 클래스에 편중될 수 있는 단점이 있음
- Bootstrap
    - 샘플 추출 시 각 데이터의 중복 추출을 허용한다.

2. 모델 성능 평가

- Confusion Matrix : 모델의 성능을 통계적인 수치로 시각화 하는 방법
    - TP(True Positive), FN(False Negative), FP(False Positive), TN(True Negative)

|실제값\예측값|Class=yes|Class=no|
|----------|---------|--------|
|**Class=yes** | TP | FN |
|**Class=no**  | FP | TN |



- Accuracy (정확도) : 모델이 정확하게 분류 또는 예측하는 데이터의 비율
    - Accuracy = TP+TN / TP+TN+FP+FN

- Precision (정밀도) : 모델이 검출한 데이터 중 올바르게 검출된 데이터의 비율
    - Precision(p) = TP / TP+FP

- Recall (재현율) : 실제 해당 데이터 중 모델이 올바르게 검출한 데이터의 비율
    - Recall(r) = TP / TP+FN

- F-Measure : Precision, Recall을 통합해 나타내는 정확도
    - F-measure = 2rp / r+p

- ROC Curve
: 민감도와 특이도의 관계를 파악할 수 있는 그래프

- Mean Squared Error (MSE)
    - 평균 제곱 오차계산
    - 회귀선과 모델 예측값 사이의 오차를 사용
    - 오차를 제곱한 값들의 평균
    - Root Mean Squared Error는 MSE의 루트값